<?xml version="1.0"?>
  <database name="VIEW BI_VENTA_V">
    <view name="BI_VENTA_V"><![CDATA[SELECT c_invoiceline.c_invoiceline_id AS bi_venta_v_id, c_invoiceline.ad_client_id, c_invoiceline.ad_org_id, c_invoiceline.isactive, c_invoiceline.created, c_invoiceline.createdby, c_invoiceline.updated, c_invoiceline.updatedby, ad_org.name AS organizacion, COALESCE(ad_user.name, 'ND') AS agente, c_invoice.documentno AS dto, c_bpartner.name AS cliente, m_product_category.name AS categoria, m_product.name AS producto, date_part('MONTH', c_invoice.dateinvoiced) AS mes, bi_mes_nombre(c_invoice.dateinvoiced) AS mes_nom, c_invoice.dateinvoiced AS fecha, c_invoiceline.qtyinvoiced AS ventasuds, c_currency_convert_precision(bi_sacacosto(c_invoiceline.m_product_id, c_invoice.dateinvoiced) * c_invoiceline.qtyinvoiced, c_currency.c_currency_id, ad_org.c_currency_id, c_invoice.dateinvoiced, 'S', c_invoice.ad_client_id, c_invoice.ad_org_id, 'A') AS costo, c_currency_convert_precision(c_invoiceline.linenetamt, c_currency.c_currency_id, ad_org.c_currency_id, c_invoice.dateinvoiced, 'S', c_invoice.ad_client_id, c_invoice.ad_org_id, 'A') AS ventasmxn, c_currency_convert_precision(c_invoiceline.linenetamt, c_currency.c_currency_id, ad_org.c_currency_id, c_invoice.dateinvoiced, 'S', c_invoice.ad_client_id, c_invoice.ad_org_id, 'A') - c_currency_convert_precision(bi_sacacosto(c_invoiceline.m_product_id, c_invoice.dateinvoiced) * c_invoiceline.qtyinvoiced, c_currency.c_currency_id, ad_org.c_currency_id, c_invoice.dateinvoiced, 'S', c_invoice.ad_client_id, c_invoice.ad_org_id, 'A') AS margen, ad_client.em_bi_es_productivo FROM c_invoice JOIN c_invoiceline ON c_invoice.c_invoice_id = c_invoiceline.c_invoice_id JOIN c_doctype ON c_invoice.c_doctype_id = c_doctype.c_doctype_id AND c_doctype.docbasetype = 'ARI' JOIN c_bpartner ON c_invoice.c_bpartner_id = c_bpartner.c_bpartner_id JOIN m_product ON c_invoiceline.m_product_id = m_product.m_product_id JOIN m_product_category ON m_product.m_product_category_id = m_product_category.m_product_category_id LEFT JOIN c_currency ON c_invoice.c_currency_id = c_currency.c_currency_id LEFT JOIN ad_org ON c_invoice.ad_org_id = ad_org.ad_org_id LEFT JOIN ad_user ON c_invoice.salesrep_id = ad_user.ad_user_id JOIN ad_client ON c_invoice.ad_client_id = ad_client.ad_client_id AND ad_client.em_bi_es_productivo = 'Y' WHERE c_invoice.docstatus = 'CO' AND c_invoice.issotrx = 'Y' AND c_invoiceline.qtyinvoiced > 0 AND bi_anio(c_invoice.dateinvoiced) = bi_anio('2014-06-23 17:50:38.585366')]]></view>
  </database>
